[build]
  command = "pnpm run optimize-images && pnpm run build"
  publish = ".next"

[dev]
  command = "pnpm run dev"
  port = 3000

[[plugins]]
  package = "@netlify/plugin-nextjs"

[[headers]]
  for = "/optimized/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# This rule forces the root path to redirect to the default language
[[redirects]]
  from = "/"
  to = "/hy"
  status = 301
  force = true

# --- SEO Canonical Redirects ---
[[redirects]]
  from = "http://samyunwanarmenia.netlify.app/*"
  to = "https://samyunwanarmenia.netlify.app/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/:path/"
  to = "/:path"
  status = 301
  force = true
  conditions = {Language = ["hy", "ru", "en"]}
  except = ["/"]
# TODO: If you add a custom domain, add an explicit canonical redirect from netlify.app to primary domain